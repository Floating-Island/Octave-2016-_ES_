%a

x=[-5.50000000000000;-5;-4.50000000000000;-4;-3.50000000000000;-3;-2.50000000000000;-2;-1.50000000000000;-1;-0.500000000000000;0;0.500000000000000;1;1.50000000000000;2;2.50000000000000;3;3.50000000000000;4;4.50000000000000;5;5.50000000000000;];
y=[80.1000000000000;65.5000000000000;52.6000000000000;41.4000000000000;31.8000000000000;23.7000000000000;17.1000000000000;11.8000000000000;7.80000000000000;5.10000000000000;3.50000000000000;3;3.50000000000000;4.90000000000000;7.20000000000000;10.2000000000000;13.9000000000000;18.3000000000000;23.2000000000000;28.6000000000000;34.4000000000000;40.5000000000000;46.9000000000000;];
plot(x,y,'.')
A=[x.^2 x x.^0];
k=pinv(A)*y;
g= @(x) (k(1)*x.^2+k(2)*1+k(3));
plot(x,y,'.',x,g(x))
norm(y-g(x))/norm(y)
k
%corregido
A=[x.^3 x.^2 x x.^0];
k=pinv(A)*y;
g= @(x) k(1)*x.^3+k(2)*x.^2+k(3)*1+k(4);
plot(x,y,'.',x,g(x))
norm(y-g(x))/norm(y)
k

%b
x=[-5.50000000000000;-5;-4.50000000000000;-4;-3.50000000000000;-3;-2.50000000000000;-2;-1.50000000000000;-1;-0.500000000000000;0;0.500000000000000;1;1.50000000000000;2;2.50000000000000;3;3.50000000000000;4;4.50000000000000;5;5.50000000000000;];
y=[4.50000000000000;5;5.50000000000000;6;6.50000000000000;7;7.50000000000000;8;8.50000000000000;9;9.60000000000000;10.1000000000000;10.7000000000000;11.3000000000000;11.9000000000000;12.7000000000000;13.7000000000000;15;16.8000000000000;19.5000000000000;23.5000000000000;29.8000000000000;40;];
plot(x,y,'.')
A=[x x.^0 exp(x)];
k=pinv(A)*y;
g= @(x) k(1)*x+k(2)*1+k(3)*exp(x);
plot(x,y,'.',x,g(x))
norm(y-g(x))/norm(y)
k

%c
x=[-5.50000000000000;-5;-4.50000000000000;-4;-3.50000000000000;-3;-2.50000000000000;-2;-1;-0.500000000000000;0;0.500000000000000;1;1.50000000000000;2;2.50000000000000;3;3.50000000000000;4;4.50000000000000;5;5.50000000000000;];
y=[1;1.60000000000000;2.30000000000000;2.90000000000000;3.60000000000000;4.20000000000000;4.90000000000000;5.50000000000000;6.80000000000000;7.50000000000000;8.10000000000000;8.80000000000000;9.40000000000000;10;10.7000000000000;11.3000000000000;12;12.7000000000000;13.3000000000000;14;14.6000000000000;15.2000000000000;];
plot(x,y,'.')

A=[x x.^0];
k=pinv(A)*y %ó k=resuelve_chol(A'*A,A'*y)
g= @(x) k(1)*x+k(2)*1;
plot(x,y,'.',x,g(x))
norm(y-g(x))/norm(y)
k
